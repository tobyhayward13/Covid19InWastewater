<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Toby Hayward, thay535, ID458894757">

<title>Dunedin Flows and Wastewater Concentration</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="dunedin_flow_files/libs/clipboard/clipboard.min.js"></script>
<script src="dunedin_flow_files/libs/quarto-html/quarto.js"></script>
<script src="dunedin_flow_files/libs/quarto-html/popper.min.js"></script>
<script src="dunedin_flow_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="dunedin_flow_files/libs/quarto-html/anchor.min.js"></script>
<link href="dunedin_flow_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dunedin_flow_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="dunedin_flow_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="dunedin_flow_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="dunedin_flow_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Dunedin Flows and Wastewater Concentration</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Toby Hayward, thay535, ID458894757 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="summary" class="level1">
<h1>Summary</h1>
<p>The same Flow/Wastewater/Rain analysis of Dunedin’s catchment sites to estimate the effect of population variance in Dunedin on the concentration of COVID-19 genome copies in Wastewater.</p>
<section id="data-in." class="level2">
<h2 class="anchored" data-anchor-id="data-in.">Data in.</h2>
<p>Using the data, I just operated in the spreadsheets quickly to get something that I can read and manipulate easily in <code>R</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wastewater Data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>waste.data <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'../data/ww_data_all.csv'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>waste.data.dunedin <span class="ot">=</span> waste.data <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SampleLocation <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'OT_DunedinTahuna'</span>, <span class="st">'OT_GreenIsland'</span>, <span class="st">'OT_Mosgiel'</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Flow Data</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>flow.dunedin <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'dunedin_flow_data.csv'</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Manipulate into something useful.</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>flow.dunedin.tidy <span class="ot">=</span> flow.dunedin <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">18</span>), <span class="at">names_to =</span> <span class="st">'start_date'</span>, <span class="at">values_to =</span> <span class="st">'daily_flow_m3'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start_date =</span> <span class="fu">mdy</span>(start_date) <span class="sc">+</span> Day <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(start_date) <span class="sc">%&gt;%</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'date'</span> <span class="ot">=</span> start_date, <span class="st">'SampleLocation'</span> <span class="ot">=</span> catchment)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Rain data</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>rain.data <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'dunedin_rain_data.csv'</span>, <span class="at">skip =</span> <span class="dv">31</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>rain.data.locations <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'dunedin_rain_data.csv'</span>, <span class="at">skip =</span> <span class="dv">1</span>, <span class="at">n_max =</span> <span class="dv">24</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">'Longitude'</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Longitude (dec.deg)</span><span class="st">`</span>, <span class="st">'Latitude'</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Latitude (dec.deg)</span><span class="st">`</span>, <span class="st">'Agent'</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Agent Number</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the rain data, we need to figure out which rain catchments are relevant. To do this, we’ll use effectively the same crude analysis as how we mapped the catchments for the other regions, except I don’t have the same tools as <em>Mackay</em>. I’ll first produce both the plots of the rain catchments and include a picture of the rain boundaries and eyeball the relevant sites.</p>
<p><img src="waste_catchments_dunedin.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>nz_region <span class="ot">=</span> <span class="fu">map_data</span>(<span class="st">'nz'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Longitude =</span> long, <span class="at">Latitude =</span> lat, group)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Longitude and Latitude to Km</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.sco.wisc.edu/2022/01/21/how-big-is-a-degree/#:~:text=Therefore%20we%20can%20easily%20compute,further%20subdivisions%20of%20a%20degree.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>longlat_ratio_km <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">78.6</span>, <span class="fl">111.1</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>(dunedin_map <span class="ot">&lt;-</span> rain.data.locations <span class="sc">%&gt;%</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude)) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> Latitude <span class="sc">+</span> <span class="fl">0.01</span>, <span class="at">label =</span> Agent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> nz_region, <span class="fu">aes</span>(<span class="at">group =</span> group), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">col =</span> <span class="st">'black'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="dunedin_flow_files/figure-html/dunedin%20rain%20map-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Too big to notice. Restrict to appropriate areas. </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>restriction <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">45.963329</span>, <span class="fl">170.804988</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span><span class="fl">45.730863</span>, <span class="fl">170.206128</span>) <span class="sc">%&gt;%</span> <span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>dunedin_map <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">rev</span>(restriction[<span class="dv">2</span>,]), <span class="at">ylim =</span> restriction[<span class="dv">1</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="dunedin_flow_files/figure-html/dunedin%20rain%20map-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Without computing <em>5km</em> distances (the threshold used last time), it is fairly obvious that the rain catchments that would be relevant to the locations are simply:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Catchment =</span> flow.dunedin.tidy<span class="sc">$</span>SampleLocation <span class="sc">%&gt;%</span> <span class="fu">unique</span>(),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Rain Catchment Agent</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">15752</span>, <span class="dv">22692</span>, <span class="dv">5361</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">Catchment</th>
<th style="text-align: right;">Rain Catchment Agent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">OT_DunedinTahuna</td>
<td style="text-align: right;">15752</td>
</tr>
<tr class="even">
<td style="text-align: left;">OT_GreenIsland</td>
<td style="text-align: right;">22692</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OT_Mosgiel</td>
<td style="text-align: right;">5361</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We could average over those which are relevant for potentially more accurate representations, but for now lets assume these locations give the best measurements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rain.data.tidy <span class="ot">=</span> rain.data <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Station <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">15752</span>, <span class="dv">22692</span>, <span class="dv">5361</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SampleLocation =</span> <span class="fu">case_when</span>(Station <span class="sc">==</span> <span class="dv">15752</span> <span class="sc">~</span> <span class="st">'OT_DunedinTahuna'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                    Station <span class="sc">==</span> <span class="dv">22692</span> <span class="sc">~</span> <span class="st">'OT_GreenIsland'</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">'OT_Mosgiel'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Date(NZST)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ymd</span>(<span class="fu">paste0</span>(<span class="fu">str_sub</span>(<span class="st">`</span><span class="at">Date(NZST)</span><span class="st">`</span>, <span class="dv">1</span>, <span class="dv">4</span>), <span class="fu">str_sub</span>(<span class="st">`</span><span class="at">Date(NZST)</span><span class="st">`</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="fu">str_sub</span>(<span class="st">`</span><span class="at">Date(NZST)</span><span class="st">`</span>, <span class="dv">7</span>, <span class="dv">8</span>))))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>(<span class="at">rain.data.tidy2 =</span> rain.data.tidy <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SampleLocation, Station, <span class="at">date =</span> <span class="st">`</span><span class="at">Date(NZST)</span><span class="st">`</span>, <span class="at">avg_rain =</span> <span class="st">`</span><span class="at">Amount(mm)</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SampleLocation) <span class="sc">%&gt;%</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_rain.lag1 =</span> <span class="fu">lag</span>(avg_rain),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_rain.lag2 =</span> <span class="fu">lag</span>(avg_rain, <span class="dv">2</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_rain.lag3 =</span> <span class="fu">lag</span>(avg_rain, <span class="dv">3</span>),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_rain.lag4 =</span> <span class="fu">lag</span>(avg_rain, <span class="dv">4</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_rain.lag5 =</span> <span class="fu">lag</span>(avg_rain, <span class="dv">5</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_rain.lag6 =</span> <span class="fu">lag</span>(avg_rain, <span class="dv">6</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_rain.lag7 =</span> <span class="fu">lag</span>(avg_rain, <span class="dv">7</span>),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,588 × 11
# Groups:   SampleLocation [3]
   SampleLo…¹ Station date       avg_r…² avg_r…³ avg_r…⁴ avg_r…⁵ avg_r…⁶ avg_r…⁷
   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 OT_Dunedi… 15752   2021-07-01     0      NA      NA        NA      NA      NA
 2 OT_GreenI… 22692   2021-07-01     0.4    NA      NA        NA      NA      NA
 3 OT_Mosgiel 5361    2021-07-01     0      NA      NA        NA      NA      NA
 4 OT_Dunedi… 15752   2021-07-02     0       0      NA        NA      NA      NA
 5 OT_GreenI… 22692   2021-07-02     0.1     0.4    NA        NA      NA      NA
 6 OT_Mosgiel 5361    2021-07-02     0       0      NA        NA      NA      NA
 7 OT_Dunedi… 15752   2021-07-03     0       0       0        NA      NA      NA
 8 OT_GreenI… 22692   2021-07-03     0       0.1     0.4      NA      NA      NA
 9 OT_Mosgiel 5361    2021-07-03     0       0       0        NA      NA      NA
10 OT_Dunedi… 15752   2021-07-04     0       0       0         0      NA      NA
# … with 1,578 more rows, 2 more variables: avg_rain.lag6 &lt;dbl&gt;,
#   avg_rain.lag7 &lt;dbl&gt;, and abbreviated variable names ¹​SampleLocation,
#   ²​avg_rain, ³​avg_rain.lag1, ⁴​avg_rain.lag2, ⁵​avg_rain.lag3, ⁶​avg_rain.lag4,
#   ⁷​avg_rain.lag5</code></pre>
</div>
</div>
</section>
<section id="modelling" class="level2">
<h2 class="anchored" data-anchor-id="modelling">Modelling</h2>
<p>Now for this stage, we’ll investigate the effect of Rain on the observed concentration of COVID-19 Genome Copies, then investigate the effect of flow, and then try see if we can estimate an effect of population variance by citing a source on population variance in Dunedin.<br>
<br>
First, lets prepare the data for modelling and store it in a <code>model.data</code> list of data.frames.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model_data <span class="ot">=</span> waste.data.dunedin <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SampleLocation, <span class="at">Date =</span> Collected, <span class="at">sars_per_person =</span> copies_per_day_per_person) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rain.data.tidy2 <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="st">'Date'</span> <span class="ot">=</span> date),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'SampleLocation'</span>, <span class="st">'Date'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(flow.dunedin.tidy <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename</span>(<span class="st">'Date'</span> <span class="ot">=</span> date, <span class="st">'daily_flow_rate_m3'</span> <span class="ot">=</span> daily_flow_m3),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'SampleLocation'</span>, <span class="st">'Date'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SampleLocation) <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(model_data) <span class="ot">=</span> <span class="fu">unique</span>(waste.data.dunedin<span class="sc">$</span>SampleLocation)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>model_data[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 101 × 13
   SampleLo…¹ Date       sars_…² Station avg_r…³ avg_r…⁴ avg_r…⁵ avg_r…⁶ avg_r…⁷
   &lt;chr&gt;      &lt;date&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 OT_Dunedi… 2021-12-29       0 15752       0      12.8     2.4     0       0  
 2 OT_Dunedi… 2022-01-05       0 15752       0       0       0       0       0  
 3 OT_Dunedi… 2022-01-10       0 15752       2.8     0       0.8     0.2     1  
 4 OT_Dunedi… 2022-01-13       0 15752       0.4     0.8     0       2.8     0  
 5 OT_Dunedi… 2022-01-17       0 15752       0       0       0       0       0.4
 6 OT_Dunedi… 2022-01-24       0 15752       0       0       0       0.8    12.6
 7 OT_Dunedi… 2022-01-27       0 15752       1.8     0       0       0       0  
 8 OT_Dunedi… 2022-01-31       0 15752       0.2     0.4     0       0.6     1.8
 9 OT_Dunedi… 2022-02-03       0 15752       1.2     1       0       0.2     0.4
10 OT_Dunedi… 2022-02-08       0 15752       0       0.2     0      14.6     8.6
# … with 91 more rows, 4 more variables: avg_rain.lag5 &lt;dbl&gt;,
#   avg_rain.lag6 &lt;dbl&gt;, avg_rain.lag7 &lt;dbl&gt;, daily_flow_rate_m3 &lt;dbl&gt;, and
#   abbreviated variable names ¹​SampleLocation, ²​sars_per_person, ³​avg_rain,
#   ⁴​avg_rain.lag1, ⁵​avg_rain.lag2, ⁶​avg_rain.lag3, ⁷​avg_rain.lag4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'../produce_modelling_summaries.R'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="rain" class="level3">
<h3 class="anchored" data-anchor-id="rain">Rain</h3>
<div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print_rainsummary.gam</span>(<span class="fu">produce_rainsummary.gam</span>(model_data<span class="sc">$</span>OT_DunedinTahuna))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print_rainsummary.gam</span>(<span class="fu">produce_rainsummary.gam</span>(model_data<span class="sc">$</span>OT_GreenIsland))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print_rainsummary.gam</span>(<span class="fu">produce_rainsummary.gam</span>(model_data<span class="sc">$</span>OT_Mosgiel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-hash="dunedin_flow_cache/html/modelling rain_31ad9909a7e962ea1a010c7c1415739d">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>

Table: OT_DunedinTahuna

| Concentration Loss %|  97.5%|  2.5%|   P-Value|
|--------------------:|------:|-----:|---------:|
|               22.251| 33.001| 9.775| 0.0007186|</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>

Table: OT_GreenIsland

| Concentration Loss %|  97.5%|   2.5%|   P-Value|
|--------------------:|------:|------:|---------:|
|               10.941| 26.718| -8.231| 0.2345925|</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>

Table: OT_Mosgiel

| Concentration Loss %|  97.5%|   2.5%|   P-Value|
|--------------------:|------:|------:|---------:|
|                9.352| 20.473| -3.326| 0.1335762|</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-10.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rain-12.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="flow" class="level3">
<h3 class="anchored" data-anchor-id="flow">Flow</h3>
<div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print_flowsummary.gam</span>(<span class="fu">produce_flowsummary.gam</span>(model_data<span class="sc">$</span>OT_DunedinTahuna))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print_flowsummary.gam</span>(<span class="fu">produce_flowsummary.gam</span>(model_data<span class="sc">$</span>OT_GreenIsland))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print_flowsummary.gam</span>(<span class="fu">produce_flowsummary.gam</span>(model_data<span class="sc">$</span>OT_Mosgiel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-hash="dunedin_flow_cache/html/modelling flow_129a752bded062706aec2ad72129e12c">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>

Table: OT_DunedinTahuna

|Quantile  | Flow Rate| % Concentration Loss Explained|    97.5%|     2.5%|  P-Value|
|:---------|---------:|------------------------------:|--------:|--------:|--------:|
|Lower 25% |  27152.00|                       51.14377| 72.87795| 11.99298| 0.017329|
|Median    |  28773.00|                       53.18897| 74.91054| 12.66165| 0.017329|
|Upper 75% |  31726.25|                       56.69751| 78.23015| 13.86687| 0.017329|</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>

Table: OT_GreenIsland

|Quantile  | Flow Rate| % Concentration Loss Explained|    97.5%|      2.5%|   P-Value|
|:---------|---------:|------------------------------:|--------:|---------:|---------:|
|Lower 25% |   7875.75|                       16.59993| 37.41551| -11.13891| 0.2099924|
|Median    |   8981.50|                       18.69856| 41.40093| -12.79912| 0.2099924|
|Upper 75% |  11273.50|                       22.88194| 48.87204| -16.31981| 0.2099924|</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>

Table: OT_Mosgiel

|Quantile  | Flow Rate| % Concentration Loss Explained|    97.5%|      2.5%|   P-Value|
|:---------|---------:|------------------------------:|--------:|---------:|---------:|
|Lower 25% |    4083.0|                       45.16122| 74.77216| -19.20528| 0.1259502|
|Median    |    4345.0|                       47.23506| 76.90598| -20.55668| 0.1259502|
|Upper 75% |    4641.5|                       49.48755| 79.10390| -22.10451| 0.1259502|</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-10.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20flow-12.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="rain-or-flow" class="level3">
<h3 class="anchored" data-anchor-id="rain-or-flow">Rain or Flow?</h3>
<div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print_flowrainsummary.gam</span>(<span class="fu">produce_flowrainsummary.gam</span>(model_data<span class="sc">$</span>OT_DunedinTahuna))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print_flowrainsummary.gam</span>(<span class="fu">produce_flowrainsummary.gam</span>(model_data<span class="sc">$</span>OT_GreenIsland))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print_flowrainsummary.gam</span>(<span class="fu">produce_flowrainsummary.gam</span>(model_data<span class="sc">$</span>OT_Mosgiel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-hash="dunedin_flow_cache/html/modelling rainandflow_420db0da0f77b0a16a0a45d8dff1b681">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>

Table: OT_DunedinTahuna

|Quantile  | Flow Rate| % Concentration Loss Explained|    97.5%|     2.5%|   P-Value|
|:---------|---------:|------------------------------:|--------:|--------:|---------:|
|Lower 25% |  27152.00|                       80.43750| 96.01318| 4.010857| 0.0441606|
|Median    |  28773.00|                       82.25313| 96.71086| 4.245155| 0.0441606|
|Upper 75% |  31726.25|                       85.13887| 97.68326| 4.670546| 0.0441606|</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rainandflow-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rainandflow-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>

Table: OT_GreenIsland

|Quantile  | Flow Rate| % Concentration Loss Explained|    97.5%|      2.5%|   P-Value|
|:---------|---------:|------------------------------:|--------:|---------:|---------:|
|Lower 25% |   7875.75|                       5.335601| 32.63044| -33.01777| 0.7481429|
|Median    |   8981.50|                       6.061568| 36.26469| -38.45432| 0.7481429|
|Upper 75% |  11273.50|                       7.548671| 43.18544| -50.44116| 0.7481429|</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rainandflow-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rainandflow-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>

Table: OT_Mosgiel

|Quantile  | Flow Rate| % Concentration Loss Explained|    97.5%|      2.5%|   P-Value|
|:---------|---------:|------------------------------:|--------:|---------:|---------:|
|Lower 25% |    4083.0|                       33.29377| 85.66411| -210.3904| 0.6001711|
|Median    |    4345.0|                       35.00448| 87.34408| -233.7899| 0.6001711|
|Upper 75% |    4641.5|                       36.88760| 89.00906| -262.4054| 0.6001711|</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rainandflow-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="dunedin_flow_files/figure-html/modelling%20rainandflow-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p><strong>Tahuna</strong> looks like the only location that seems to be showing any significance in a correlation between Rain/Flow on the concentration of genome copies. Perhaps including some information about population variance would provide some more insight?</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>